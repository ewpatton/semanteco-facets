<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>CSV2Table</title>

	<link rel="stylesheet" href="css/csvtable.css" type="text/css" />

	<script type="text/javascript" src="js/jquery-1.4.2.min.js"></script>
	<script type="text/javascript" src="js/jquery.csvToTable.js"></script>
	<script type="text/javascript" src="js/jquery.tablesorter.min.js"></script>
	<script type="text/javascript" src="js/jquery.jstree.js"></script>
	<script type="text/javascript" src="_docs/syntax/!script.js"></script>
	<script src="http://code.jquery.com/ui/1.10.0/jquery-ui.js"></script>
    <script src="http://code.jquery.com/ui/1.10.1/jquery-ui.js"></script>
    
    <script>
    $(function() {

        //Check File API support
        if (window.File && window.FileList && window.FileReader) {
            var filesInput = document.getElementById("files");

            filesInput.addEventListener("change", function(event) {

                var files = event.target.files; //FileList object
                var output = document.getElementById("result");

                for (var i = 0; i < files.length; i++) {
                    var file = files[i];

                    //Only plain text
                    if (!file.type.match('plain')) continue;

                    var picReader = new FileReader();

                    picReader.addEventListener("load", function(event) {

                        var textFile = event.target;

                        var div = document.createElement("div");
                        
                        $("#wtf").html(textFile.result);

                        div.innerText = textFile.result;

                        output.insertBefore(div, null);

                    });

                    //Read the text file
                    picReader.readAsText(file);
                }

            });
        }
        else {
            console.log("Your browser does not support File API");
        }
    });
    </script>
	 
	<script type="text/javascript" class="source below">
		var class_hierachy=[["Property",null],["testnode","Resource"],["Resource","Property"],["Literal","Property"],["Boolean","Property"],["testnode","Literal"]];
         var show=new Array();
         var len=0;        
		 
		function initial_hierachy(){
			var temp_div=document.getElementById('tree');
			temp_div.innerHTML="";
			var ul=document.createElement("ul");
			var li=document.createElement("li");
			var a=document.createElement("a");
			a.href="#";
			var text=document.createTextNode(class_hierachy[0][0]);
			li.id=0;
			a.appendChild(text); 
			li.appendChild(a); 
			ul.appendChild(li); 
			temp_div.appendChild(ul); 
			document.getElementById('description').appendChild(temp_div);
	  	    
			//alert("success");
			
			var i=0+1;
			if (i<class_hierachy.length){
		    	for (var i=1;i<class_hierachy.length;i++){ 
					append_node(i,0);
				}
		    }
			$(function () {
				$("#tree")
					.jstree({
						"themes" : {
           					 "theme" : "default",
           					 "dots" : true,
          					 "icons" : true,
					 	     "url": "themes/default/style.css"
       					},
       					
       					"core" : { "initially_open" : [ "0" ] },
       					
       					"dnd" : {
       		                "drop_target" : "#CSVTable2",
       		                "drop_finish" : function (data) {
       		                    if(data.o.attr("rel") === "ds") {
       		                      //update chart with new data here?
       		                      //using data.o.attr("id")
       		                    }
       		                }
       		            },
       		            "crrm" : { move : { check_move : function (m) { return false; } } },

						 "plugins" : ["themes","html_data","dnd","ui","types","crrm"] })
						
							// 1) if using the UI plugin bind to select_node
			
							.bind("select_node.jstree", function (event, data) { 
							// `data.rslt.obj` is the jquery extended node that was clicked
							    var temp=data.rslt.obj.attr("id");
								alert(class_hierachy[temp][0]);
								alert(class_hierachy[temp][1]);
						})
							// 2) if not using the UI plugin - the Anchor tags work as expected
							//    so if the anchor has a HREF attirbute - the page will be changed
					//    you can actually prevent the default, etc (normal jquery usage)
							.delegate("a", "click", function (event, data) { event.preventDefault(); })
			});
	
		}
		function append_node(current, parent){
		    if(class_hierachy[current][1]==class_hierachy[parent][0]){
				var temp_div=document.getElementById(parent);
				var ul=document.createElement("ul");
				var li=document.createElement("li");
				var a=document.createElement("a");
				a.href="#";
				var text=document.createTextNode(class_hierachy[current][0]);
				li.id=current;
				a.appendChild(text); 
				li.appendChild(a); 
				ul.appendChild(li); 
				temp_div.appendChild(ul); 
	  	 	    //alert("success");
				//var i=current+1;
				//if (i<class_hierachy.length){
		    		for (var i=0;i<class_hierachy.length;i++){ 
						append_node(i,current);
				//}
		    }
			}
		}	
		
		document.onkeydown = keyDown;
		
		function keyDown(){
             if(event.keyCode==8){
             	var temp =document.getElementById('search_info').value;
             
            	var cprStr=temp;
             	if(cprStr.length!=1&&cprStr.length!=0){             
             		cprStr=cprStr.substring(0,cprStr.length-1);
             
            		show=[];
            		len=0;
            		for (i in class_hierachy){
             			if(cprStr==class_hierachy[i][0].substring(0,cprStr.length)){
            	    		len=show.push(class_hierachy[i][0]);
                		}
             		} 
            	 }
	     	 else{
		 	show=[]
                 }
            	 //alert("Have "+len+" compatible records");
	   	  var div1=document.getElementById('show');
           	  div1.innerHTML="";
           	  htmlStr=""
           	  for (i in show){
              	  htmlStr+="<a style=\"cursor: pointer;\" onclick=\"choose(this)\">"
               	  htmlStr+=show[i];
				  htmlStr+="</a>"
                  htmlStr+="</br>";
             }
	    	  div1.innerHTML+=htmlStr;
            	  //alert(show);
             }
             
         }
		
		
		function press(event){
	     var e=event.srcElement;
             if(event.keyCode!=13){
                 if(event.keyCode!=8){
		     var realkey = String.fromCharCode(event.keyCode);
	             match(realkey);
	    	     return false;
                 }
                 
             }
         }
		
		function match(str){

             //alert(document.getElementById('textarea2').value);
             var temp =document.getElementById('search_info').value;
             
             
             var cprStr=temp+str;
    
             show=[];
             len=0;
             for (i in class_hierachy){
             	if(cprStr==class_hierachy[i][0].substring(0,cprStr.length)){
            	    len=show.push(class_hierachy[i][0]);
                }
             } 
             //alert("Have "+len+" compatible records");
	     var div1=document.getElementById('show');
             div1.innerHTML="";
             htmlStr=""
             for (i in show){
			 	htmlStr+="<a style=\"cursor: pointer;\" onclick=\"choose(this)\">"
                htmlStr+=show[i];
				htmlStr+="</a>"
                htmlStr+="</br>";
             }
	     div1.innerHTML+=htmlStr;
         }
		function choose(str){
			var temp=str.childNodes[0].nodeValue;
			document.getElementById('search_info').value=temp;
			document.getElementById('show').innerHTML="";
		}
		
		function search_node(){
			 var temp =document.getElementById('search_info').value;
			 var flag=0;
			 for (var i=0;i<class_hierachy.length;i++){
			 	if(temp==class_hierachy[i][0]){
					flag=1;
					if(document.all){
						document.getElementById(i).firstChild.click();
					}
					else{
						var evt = document.createEvent("MouseEvents");  
     	 				evt.initEvent("click", true, true);  
       			  	    document.getElementById(i).childNodes[1].dispatchEvent(evt);  
					}
					//alert(" found !");
					break;
				}
			 }
			 if(flag==0){
			 	alert(" not found !")
			 }
			 document.getElementById('search_info').value="";
			 document.getElementById('show').innerHTML="";
		}
		

		
	</script>
	
	
	<script>

	$(function(){ $('#button1').click(function() {
		$.get('test.csv', function(data) {
			$('#CSVSource').html('<pre>' + data + '</pre>');
		});
		$('#CSVTable').CSVToTable('test.csv', { loadingImage: 'images/loading.gif', startLine: 0 });
		$.get('test.csv', function(data) {
			$('#TSVSource').html('<pre>' + data + '</pre>');
		});
		$('#TSVTable').CSVToTable('test.csv', { loadingText: 'Loading TSV Data...', loadingImage: 'images/loading.gif', startLine: 0, separator: "\t" });
		$('#CSVTable2').CSVToTable('test.csv', { loadingImage: 'images/loading.gif', startLine: 0 }).bind("loadComplete",function() { 
			$('#CSVTable2').find('TABLE').tablesorter();
		});;
	});
	});
	</script>
	<script>
/*	$(function() {
		$.get('test.csv', function(data) {
			$('#CSVSource').html('<pre>' + data + '</pre>');
		});
		$('#CSVTable').CSVToTable('test.csv', { loadingImage: 'images/loading.gif', startLine: 0 });
		$.get('test.csv', function(data) {
			$('#TSVSource').html('<pre>' + data + '</pre>');
		});
		$('#TSVTable').CSVToTable('test.csv', { loadingText: 'Loading TSV Data...', loadingImage: 'images/loading.gif', startLine: 0, separator: "\t" });
		$('#CSVTable2').CSVToTable('test.csv', { loadingImage: 'images/loading.gif', startLine: 0 }).bind("loadComplete",function() { 
			$('#CSVTable2').find('TABLE').tablesorter();
		});;
	}); 
*/	</script>

<style>
body{
    font-family: 'Segoe UI';
    font-size: 12pt;
}

header h1{
    font-size:12pt;
    color: #fff;
    background-color: #1BA1E2;
    padding: 20px;

}
article
{
    width: 80%;
    margin:auto;
    margin-top:10px;
}


input[type='file']{
    margin:10px;
}
</style>


</head>
<body onload="initial_hierachy()">

<br><br>
Please upload a CSV file: 
<br><br>
<input type="file" id="files" name="files[]" multiple /><button id="button1">Upload</button>
<output id="list"></output>

<script>
  function handleFileSelect(evt) {
    var files = evt.target.files; // FileList object

    // files is a FileList of File objects. List some properties.
    var output = [];
    for (var i = 0, f; f = files[i]; i++) {
      output.push('<li><strong>', escape(f.name), '</strong> (', f.type || 'n/a', ') - ',
                  f.size, ' bytes, last modified: ',
                  f.lastModifiedDate ? f.lastModifiedDate.toLocaleDateString() : 'n/a',
                  '</li>');
    }
    document.getElementById('list').innerHTML = '<ul>' + output.join('') + '</ul>';
  }

  document.getElementById('files').addEventListener('change', handleFileSelect, false);
</script>


<br><br>
<div style="float:left;width:70%;">
<div id="CSVSource" class="source" >
</div>

<br><br>
CSV To Table:<br>


<div id="CSVTable2">

</div>
   <article>
        <label for="files">Select a file: </label>
        <input id="files" type="file" />
        <output id="result" />
        <div id="wtf"></div>
    </article>
</div>

<div style="margin-left:70%; width:30%;">
<div>

 <table cellpadding="0"; cellspacing="0">
      <tr>
	    <td colspan="2">
		   
		</td>
	  </tr>
	 <tr>
          <td  ><div id="text"  ><textarea name ="search" id="search_info" style=" overflow:hidden;padding:0 ;width:100%;height:100%;border:1;" placeholder="Type message here!" onKeyPress="press(event)"></textarea></div>
		  <td style=" width:20%;"><input type=button onClick=" search_node()" value="search"/></td>
		  </td>         
      
     </tr>
	 <tr>
          <td colspan="2">       
           <div id="description" style="  border:1px solid #111111; overFlow: auto; " >
			<div id="tree" class="demo" style="width:120%;height:500px;">

			</div>

			</div>
		  </td>
     </tr>
	
    </table>

</div>
</div>
<div style="clear:both"></div>


</body>
</html>